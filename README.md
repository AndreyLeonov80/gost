# gost
**ИИ для работы с рассуждениями и QA по ГОСТам**

**Задача** https://habr.com/ru/companies/omk-it/articles/850434/

**Верхнеуровневая текущая и стратегическая "Архитекура ИИ решения"**

![Архитектура ИИ решения](https://raw.githubusercontent.com/AndreyLeonov80/gost/refs/heads/main/back/architecture/%D0%92%D0%B5%D1%80%D1%85%D0%BD%D0%B5%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D0%B5%D0%B2%D0%B0%D1%8F%20%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B0%D1%8F%20%D0%B8%20%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B5%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%22%D0%90%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%83%D1%80%D0%B0%20%D0%98%D0%98%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F%22.png)

**Методология на примере ГОСТ 14637-89.pdf.**

1. Сегментация и очистка PDF-файла

       Разделение документа на информационные блоки и таблицы.
       Очистка данных от лишней информации.
       Результат сохраняется в: gost/back/py/datasource/infoblocks/ГОСТ 14637-89 - null.txt

2. Генерация пакета QA через LLM и промт-инжиниринг
        
       Файлы находятся в директории: gost/back/py/datasource

4. Обучение модели 

   Выполнить
  
       pip install -r requirements.txt
   
   В gost/back/py/train.py
  
       указать полный путь с json файлами в директории datasource например
       base_path = '/Users/aiapi/Desktop/prj_omk/omkllm/291024/gost/back/py'
   
       указать модель обучения которая сохранится в файл self.model_path = 'trained_model.pkl' (или trained_model_promt_template.pkl)

   Запустить gost/back/py/train.py для обучения модели на основе QA данных
	
       логи
       qa_model_20241030_115625.log для модели trained_model.pkl
       trained_model_promt_template.pkl.log для модели trained_model_promt_template.pkl (или trained_model_promt_template.pkl)

4. Проверяем модель на copilot gost/back/py/copilot.py
   
       указать полный путь для pkl модели например
       base_path = '/Users/aiapi/Desktop/prj_omk/omkllm/291024/gost/back/py'
   
       указать pkl модель self.model_path = 'trained_model.pkl' (или trained_model_promt_template.pkl)

**Варианты LLM:**
  - платные api gpt4 https://platform.openai.com/docs/concepts
  - платные api claude https://docs.anthropic.com/en/home
  - платные c большим выбором моделей без своего GPU https://openrouter.ai
  - локальные LLM например через сервер настроенный в https://lmstudio.ai
  - аренда gpu например https://immers.cloud

Тюнинг параметров LLM от которых зависити результат - могу описать по запросу.

**Демо-сервер на Flutter:**
     
Приложение: https://appomk.frontback.tech

Видео демонстрация: https://cloud.mail.ru/public/K75R/Rc9Jq5pGZ

Модели и результаты:
- **trained_model.pkl** (обучена на **ГОСТ 14637-89.pdf** через гиперсегментацию ГОСТа на инфоблоки/таблицы)
  
  Видео https://cloud.mail.ru/public/jSCk/txkSYpVw7

      промт gost/back/py/datasource/infoblocks/promts.txt
      QA обучающая выборка:
       - gost/back/py/datasource/infoblocks
       - gost/back/py/datasource/tables

- **trained_model_promt_template.pkl** (обучена на **ГОСТ 14637-89.pdf** через вариации промта "Какие границы для испытания на временное сопротивление для широкополосного проката, марка стали Ст3сп, толщина проката 20, категория 5 для ГОСТ 14637-89?")
    
      промт gost/back/py/datasource/infoblocks2/gen-llm plk promt.txt
      QA обучающая выборка gost/back/py/datasource/infoblocks2/89-1.json

# Методы улучшения модели MaterialsQAModel

## Методы обработки векторных представлений

### transform_embeddings()
- Контекстные эмбеддинги на основе трансформеров
- Снижение размерности (UMAP/t-SNE)
- Поддержка многоязычных эмбеддингов
- Обработка внесловарных токенов

### optimize_vectorizer_parameters()
- Настройка параметров TF-IDF (`max_features`, `ngram_range`, `min_df`)
- Оптимизация размера словаря
- Отбор признаков
- Экспериментальная настройка для улучшения точности

## Методы работы с данными

### augment_training_data()
- Генерация вариаций вопросов
- Обратный перевод для создания парафразов
- Использование T5/GPT для перефразирования
- Сохранение семантики ответов

### expand_question_variants()
- Создание парафразов вопросов
- Улучшение понимания различных формулировок
- Расширение обучающей выборки

### rank_data_sources()
- Ранжирование источников по точности
- Оценка надежности источников
- Приоритизация качественных данных

## Методы оценки качества

### calculate_bert_similarity()
- Предобученные BERT эмбеддинги
- Расчет схожести на основе внимания
- Межъязыковое сравнение
- Анализ схожести на уровне токенов

### calculate_model_confidence()
- Оценка уверенности модели в ответах
- Система подсчета баллов уверенности
- Прозрачность надежности ответов

### validate_answer_quality()
- Проверка семантической согласованности
- Валидация по базе знаний
- Оценка полноты ответов
- Выявление противоречий

### filter_low_confidence_answers()
- Фильтрация ответов с низкой уверенностью
- Предотвращение неточных ответов
- Повышение доверия пользователей

## Методы кластеризации и валидации

### optimize_question_clusters()
- Иерархическая кластеризация
- Плотностная кластеризация (DBSCAN)
- Оптимизация границ кластеров
- Динамическое обновление

### cross_validate_answers()
- K-блочная валидация
- Стратифицированная выборка
- Анализ ошибок
- Отслеживание метрик

## Методы генерации ответов

### ensemble_answer_generation()
- Взвешенное голосование
- Стекинг моделей
- Выбор по уверенности
- Динамическая настройка весов

### contextual_answer_generation()
- Учет контекста вопроса
- Анализ связанных вопросов
- Улучшение полноты ответов

## Методы анализа и адаптации

### analyze_failure_patterns()
- Отслеживание проблемных вопросов
- Категоризация ошибок
- Выявление слабых мест модели

### adaptive_training_cycle()
- Непрерывное обучение на новых данных
- Периодическое обновление модели
- Поддержание актуальности ответов

### fine_tune_on_feedback()
- Обучение на основе обратной связи
- Улучшение точности ответов
- Адаптация к пользовательским потребностям

### suggest_similar_unanswered_questions()
- Поиск похожих вопросов без ответов
- Расширение базы знаний
- Улучшение покрытия тем

## Метрики эффективности
- Точность ответов
- Время отклика
- Использование памяти
- Оценки уверенности
- Результаты кросс-валидации

## Рекомендации по интеграции
1. Поэтапное внедрение методов
2. Независимое тестирование
3. Мониторинг производительности
4. Валидация на тестовой выборке
5. Документирование конфигураций

**Алгоритмы/технологии которые есть в запасе и которые можно отдельно обсудить:**
- добавление новых вопросов в обученную модель, обновляя TF-IDF векторизацию с помощью partial_fit
- матчинг вопросов и в целом матчинг терминов
- распознавание таблиц и ячеек таблиц, если они являются графическими элементами 
- оптимизации алгоритмов
- ИИ copilot по ГОСТам для документооборота в структурах сделок
- openapi backend api
- другие
 
**Контакты:**

andrey.leonov@bimeister.com

https://t.me/aidialog

**О архитекторе и разработчике:**

https://codeboost.ru/about